

## Упражнение 00 — Подберём цены для Кати

| Упражнение 00: Подберём цены для Кати |                  |
| ------------------------------------- | ---------------- |
| Каталог сдачи                         | ex00             |
| Файлы                                 | `day03_ex00.sql` |
| **Разрешено**                         | ANSI SQL         |

Напишите SQL‑запрос, который вернёт название пиццы, её цену, название пиццерии и дату визита Кати, где цена 800–1000 руб. Отсортируйте по пицце, цене и пиццерии.  

| pizza_name      | price | pizzeria_name | visit_date |
| --------------- | ----- | ------------- | ---------- |
| cheese pizza    | 950   | DinoPizza     | 2022-01-04 |
| pepperoni pizza | 800   | Best Pizza    | 2022-01-03 |
| ...             | ...   | ...           | ...        |

---

## Глава V

## Упражнение 01 — Найдём забытые меню

| Упражнение 01: Найдём забытые меню |                   |
| ---------------------------------- | ----------------- |
| Каталог сдачи                      | ex01              |
| Файлы                              | `day03_ex01.sql`  |
| **Разрешено**                      | ANSI SQL          |
| **Запрещено**                      | Любые типы `JOIN` |

Найдите все **идентификаторы меню**, которые **никто никогда не заказывал**.  
Результат отсортировать по идентификатору.  

| menu_id |
| ------- |
| 5       |
| 10      |
| ...     |

---

## Глава VI

## Упражнение 02 — Забытые пиццы и пиццерии

| Упражнение 02: Забытые пиццы и пиццерии |                  |
| --------------------------------------- | ---------------- |
| Каталог сдачи                           | ex02             |
| Файлы                                   | `day03_ex02.sql` |
| **Разрешено**                           | ANSI SQL         |

Используйте запрос из упражнения 01 и выведите **названия пицц** из пиццерий, которые никто не заказывал.  
Добавьте цену.  
Отсортируйте результат по названию пиццы и цене.  

| pizza_name   | price | pizzeria_name |
| ------------ | ----- | ------------- |
| cheese pizza | 700   | Papa Johns    |
| cheese pizza | 780   | DoDo Pizza    |
| ...          | ...   | ...           |

---

## Глава VII

## Упражнение 03 — Сравним посещения

| Упражнение 03: Сравним посещения |                  |
| -------------------------------- | ---------------- |
| Каталог сдачи                    | ex03             |
| Файлы                            | `day03_ex03.sql` |
| **Разрешено**                    | ANSI SQL         |

Найдите пиццерии, которые **чаще посещали мужчины или женщины**.  
Используйте операторы множеств (**UNION ALL, EXCEPT ALL, INTERSECT ALL**) с сохранением дубликатов.  
Отсортируйте по названию пиццерии.  

| pizzeria_name |
| ------------- |
| Best Pizza    |
| Dominos       |
| ...           |

---

## Глава VIII

## Упражнение 04 — Сравним заказы

| Упражнение 04: Сравним заказы |                  |
| ----------------------------- | ---------------- |
| Каталог сдачи                 | ex04             |
| Файлы                         | `day03_ex04.sql` |
| **Разрешено**                 | ANSI SQL         |

Найдите объединение имен пиццерий, у которых **заказы есть только у женщин** и которые **заказы есть только у мужчин**.  
Используйте обычные операторы множеств (без ALL — дубликаты не сохраняются).  
Отсортируйте по названию пиццерии.  

| pizzeria_name |
| ------------- |
| Papa Johns    |

---

## Глава IX

## Упражнение 05 — Посетил, но не сделал заказ

| Упражнение 05: Посетил, но не сделал заказ |                  |
| ------------------------------------------ | ---------------- |
| Каталог сдачи                              | ex05             |
| Файлы                                      | `day03_ex05.sql` |
| **Разрешено**                              | ANSI SQL         |

Напишите запрос, который вернёт список пиццерий, которые посещал **Андрей**, но **не делал заказов**.  
Отсортировать по названию пиццерии.  

| pizzeria_name |
| ------------- |
| Pizza Hut     |

---

## Глава X

## Упражнение 06 — Пиццы с одинаковой ценой

| Упражнение 06: Пиццы с одинаковой ценой |                  |
| --------------------------------------- | ---------------- |
| Каталог сдачи                           | ex06             |
| Файлы                                   | `day03_ex06.sql` |
| **Разрешено**                           | ANSI SQL         |

Найдите одинаковые по названию пиццы, имеющие одинаковую цену, но продающиеся в разных пиццериях.  
Отсортируйте по названию пиццы.  

| pizza_name   | pizzeria_name_1 | pizzeria_name_2 | price |
| ------------ | --------------- | --------------- | ----- |
| cheese pizza | Best Pizza      | Papa Johns      | 700   |
| ...          | ...             | ...             | ...   |

---

## Глава XI

## Упражнение 07 — Приготовим новую пиццу

| Упражнение 07: Приготовим новую пиццу |                  |
| ------------------------------------- | ---------------- |
| Каталог сдачи                         | ex07             |
| Файлы                                 | `day03_ex07.sql` |
| **Разрешено**                         | ANSI SQL         |

Добавьте новую пиццу **"greek pizza"** (id = 19) по цене **800 рублей** в пиццерию "Dominos" (pizzeria_id = 2).  

⚠️ Внимание: это упражнение меняет данные. Чтобы восстановить БД — используйте [скрипт модели](materials/model.sql).  

---

## Глава XII

## Упражнение 08 — Ещё одна пицца, но динамично

| Упражнение 08: Ещё одна пицца, но динамично |                                                                  |
| ------------------------------------------- | ---------------------------------------------------------------- |
| Каталог сдачи                               | ex08                                                             |
| Файлы                                       | `day03_ex08.sql`                                                 |
| **Разрешено**                               | ANSI SQL                                                         |
| **Запрещено**                               | Использовать прямые числа в качестве Primary Key или pizzeria_id |

Добавьте пиццу **"sicilian pizza"**, где id вычисляется по формуле:  
**текущее MAX(id) + 1**,  
цена = 900 рублей, пиццерия = "Dominos" (id через подзапрос).  

⚠️ Может поломать данные, восстанавливать БД снова скриптом!  

---

## Глава XIII

## Упражнение 09 — Новая пицца = новые визиты

| Упражнение 09: Новая пицца = новые визиты |                                          |
| ----------------------------------------- | ---------------------------------------- |
| Каталог сдачи                             | ex09                                     |
| Файлы                                     | `day03_ex09.sql`                         |
| **Разрешено**                             | ANSI SQL                                 |
| **Запрещено**                             | Прямые числа вместо ключей и id пиццерий |

Добавьте визиты в "Dominos" от **Дениса** и **Ирины** — **24 февраля 2022 года**.  

---

## Глава XIV

## Упражнение 10 — Новые визиты = новые заказы

| Упражнение 10: Новые визиты = новые заказы |                         |
| ------------------------------------------ | ----------------------- |
| Каталог сдачи                              | ex10                    |
| Файлы                                      | `day03_ex10.sql`        |
| **Разрешено**                              | ANSI SQL                |
| **Запрещено**                              | Прямые числа для ключей |

Добавьте заказы от **Дениса** и **Ирины** в тот же день (24.02.2022) на **"sicilian pizza"**.  

---

## Глава XV

## Упражнение 11 — “Улучшим” цену для клиентов

| Упражнение 11: “Улучшим” цену для клиентов |                  |
| ------------------------------------------ | ---------------- |
| Каталог сдачи                              | ex11             |
| Файлы                                      | `day03_ex11.sql` |
| **Разрешено**                              | ANSI SQL         |

Снизьте цену на **"greek pizza"** на **10% от текущей**.  

---

## Глава XVI

## Упражнение 12 — Приходят новые заказы!

| Упражнение 12: Приходят новые заказы! |                                                                              |
| ------------------------------------- | ---------------------------------------------------------------------------- |
| Каталог сдачи                         | ex12                                                                         |
| Файлы                                 | `day03_ex12.sql`                                                             |
| **Разрешено**                         | ANSI SQL, `generate_series(...)`, вставка через `INSERT INTO ... SELECT ...` |
| **Запрещено**                         | - Прямые числа для ключей и меню                                             |

- Window-функции (`ROW_NUMBER()` и пр.)  
- Автономные `INSERT` |  

Добавьте новые заказы **всех клиентов** на **"greek pizza"** от **25 февраля 2022 года**.  

---

## Глава XVII

## Упражнение 13 — Возврат денег клиентам

| Упражнение 13: Возврат денег клиентам |                  |
| ------------------------------------- | ---------------- |
| Каталог сдачи                         | ex13             |
| Файлы                                 | `day03_ex13.sql` |
| **Разрешено**                         | ANSI SQL         |

Напишите **2 SQL‑запроса (DML)**:  

1. Удалите все новые заказы из упражнения 12 (по дате).  
2. Удалите "greek pizza" из меню.  

---
