# 

## Упражнение 00 — Простая агрегированная информация

| Exercise 00: Простая агрегированная информация |                  |
| ---------------------------------------------- | ---------------- |
| Директория для сдачи                           | ex00             |
| Файлы для сдачи                                | `day07_ex00.sql` |
| **Разрешено**                                  |                  |
| Язык                                           | ANSI SQL         |

Напишите SQL‑запрос, который возвращает идентификатор человека и соответствующее количество посещений любых пиццерий.  
Отсортируйте результат по числу посещений по убыванию и по `person_id` по возрастанию.  

Пример:  

| person_id | count_of_visits |
| --------- | --------------- |
| 9         | 4               |
| 4         | 3               |
| …         | …               |

---

## Упражнение 01 — Давайте посмотрим настоящие имена

| Exercise 01: Давайте посмотрим настоящие имена |                  |
| ---------------------------------------------- | ---------------- |
| Директория для сдачи                           | ex01             |
| Файлы для сдачи                                | `day07_ex01.sql` |
| **Разрешено**                                  |                  |
| Язык                                           | ANSI SQL         |

Модифицируйте запрос из Упражнения 00: вместо `person_id` верните имя человека.  
Добавьте условие: нужно показать только **топ‑4 людей** с максимальным количеством посещений, при этом отсортировать по имени.  

Пример:  

| name    | count_of_visits |
| ------- | --------------- |
| Дмитрий | 4               |
| Денис   | 3               |
| …       | …               |

---

## Упражнение 02 — Статистика ресторанов

| Exercise 02: Статистика ресторанов |                  |
| ---------------------------------- | ---------------- |
| Директория для сдачи               | ex02             |
| Файлы для сдачи                    | `day07_ex02.sql` |
| **Разрешено**                      |                  |
| Язык                               | ANSI SQL         |

Напишите SQL‑запрос, который возвращает 3 любимых ресторана:

- по посещениям,  
- по заказам.  

Добавьте столбец `action_type` со значением **'visit'** или **'order'** (в зависимости от источника данных).  
Результат отсортируйте:  

1. сначала по `action_type` (возрастание),  
2. потом по `count` (убывание).  

Пример:  

| name    | count | action_type |
| ------- | ----- | ----------- |
| Dominos | 6     | order       |
| …       | …     | …           |
| Dominos | 7     | visit       |
| …       | …     | …           |

---

## Упражнение 03 — Статистика ресторанов #2

| Exercise 03: Статистика ресторанов #2 |                  |
| ------------------------------------- | ---------------- |
| Директория для сдачи                  | ex03             |
| Файлы для сдачи                       | `day07_ex03.sql` |
| **Разрешено**                         |                  |
| Язык                                  | ANSI SQL         |

Напишите SQL‑запрос, который:  

- группирует рестораны по посещениям и заказам,  
- объединяет данные по имени ресторана,  
- считает **сумму заказов и визитов**.  

Учитывайте, что некоторые рестораны могут быть только в одной из таблиц.  

Сортировка:  

- по `total_count` (по убыванию),  
- по `name` (по возрастанию).  

Пример:  

| name      | total_count |
| --------- | ----------- |
| Dominos   | 13          |
| DinoPizza | 9           |
| …         | …           |

---

## Упражнение 04 — Условие для групп

| Exercise 04: Условие для групп |                  |
| ------------------------------ | ---------------- |
| Директория для сдачи           | ex04             |
| Файлы для сдачи                | `day07_ex04.sql` |
| **Разрешено**                  |                  |
| Язык                           | ANSI SQL         |
| **Запрещено**                  |                  |
| Конструкция                    | `WHERE`          |

Напишите SQL‑запрос, который возвращает имя человека и количество его посещений пиццерий, **если он был там больше 3 раз**.  

Пример:  

| name    | count_of_visits |
| ------- | --------------- |
| Дмитрий | 4               |

---

## Упражнение 05 — Уникальность людей

| Exercise 05: Уникальность людей |                                                       |
| ------------------------------- | ----------------------------------------------------- |
| Директория для сдачи            | ex05                                                  |
| Файлы для сдачи                 | `day07_ex05.sql`                                      |
| **Разрешено**                   |                                                       |
| Язык                            | ANSI SQL                                              |
| **Запрещено**                   |                                                       |
| Конструкции                     | `GROUP BY`, любые операции множеств (`UNION` и т. п.) |

Напишите SQL‑запрос, который возвращает список уникальных имён людей, сделавших заказы в пиццериях.  
Отсортируйте результат по имени.  

Пример:  

| name   |
| ------ |
| Андрей |
| Анна   |
| …      |

---

## Упражнение 06 — Метрики ресторана

| Exercise 06: Метрики ресторана |                  |
| ------------------------------ | ---------------- |
| Директория для сдачи           | ex06             |
| Файлы для сдачи                | `day07_ex06.sql` |
| **Разрешено**                  |                  |
| Язык                           | ANSI SQL         |

Напишите SQL‑запрос, который возвращает для каждой пиццерии:  

- количество заказов,  
- среднюю цену (округлённую до 2 знаков),  
- максимальную цену,  
- минимальную цену.  

Отсортируйте результат по имени ресторана.  

Пример:  

| name       | count_of_orders | average_price | max_price | min_price |
| ---------- | --------------- | ------------- | --------- | --------- |
| Best Pizza | 5               | 780           | 850       | 700       |
| DinoPizza  | 5               | 880           | 1000      | 800       |
| …          | …               | …             | …         | …         |

---

## Упражнение 07 — Средний глобальный рейтинг

| Exercise 07: Средний глобальный рейтинг |                  |
| --------------------------------------- | ---------------- |
| Директория для сдачи                    | ex07             |
| Файлы для сдачи                         | `day07_ex07.sql` |
| **Разрешено**                           |                  |
| Язык                                    | ANSI SQL         |

Напишите SQL‑запрос, который возвращает общий средний рейтинг (имя атрибута — `global_rating`) для всех ресторанов.  
Округлите результат до 4 знаков после запятой.  

---

## Упражнение 08 — Найдите расположения ресторанов‑пиццерий

| Exercise 08: Найдите расположения ресторанов‑пиццерий |                  |
| ----------------------------------------------------- | ---------------- |
| Директория для сдачи                                  | ex08             |
| Файлы для сдачи                                       | `day07_ex08.sql` |
| **Разрешено**                                         |                  |
| Язык                                                  | ANSI SQL         |

Мы знаем адреса клиентов. Примем допущение, что человек посещает только пиццерии в своём городе.  

Напишите SQL‑запрос, который для каждого адреса возвращает:  

- сам адрес,  
- название пиццерии,  
- количество заказов этого клиента.  

Отсортируйте результат по адресу, затем по имени ресторана.  

Пример:  

| address | name       | count_of_orders |
| ------- | ---------- | --------------- |
| Казань  | Best Pizza | 4               |
| Казань  | DinoPizza  | 4               |
| …       | …          | …               |

---

## Упражнение 09 — Явное преобразование типов

| Exercise 09: Явное преобразование типов |                  |
| --------------------------------------- | ---------------- |
| Директория для сдачи                    | ex09             |
| Файлы для сдачи                         | `day07_ex09.sql` |
| **Разрешено**                           |                  |
| Язык                                    | ANSI SQL         |

Напишите SQL‑запрос, который возвращает агрегированные данные по каждому адресу:  

- адрес,  
- формула: `максимальный_возраст – (минимальный_возраст / максимальный_возраст)`,  
- средний возраст по адресу,  
- сравнение: если формула > среднего, то **true**, иначе — **false**.  

Отсортируйте результат по адресу.  

Пример:  

| address | formula | average | comparison |
| ------- | ------- | ------- | ---------- |
| Казань  | 44.71   | 30.33   | true       |
| Москва  | 20.24   | 18.5    | true       |
| …       | …       | …       | …          |
