# День 02 — SQL Bootcamp



## Задание 00 — Двигаемся влево, двигаемся вправо

| Задание 00: Двигаемся влево, двигаемся вправо |                                                                        |
| --------------------------------------------- | ---------------------------------------------------------------------- |
| Каталог для сдачи                             | ex00                                                                   |
| Файл для сдачи                                | `day02_ex00.sql`                                                       |
| **Разрешено**                                 |                                                                        |
| Язык                                          | ANSI SQL                                                               |
| **Запрещено**                                 |                                                                        |
| Конструкции SQL                               | `NOT IN`, `IN`, `NOT EXISTS`, `EXISTS`, `UNION`, `EXCEPT`, `INTERSECT` |

Напишите SQL-запрос, который возвращает список пиццерий с их рейтингом, которые **не посещались людьми**.  

---

## Глава V

## Задание 01 — Поиск пропущенных данных

| Задание 01: Поиск пропущенных данных |                                                                        |
| ------------------------------------ | ---------------------------------------------------------------------- |
| Каталог для сдачи                    | ex01                                                                   |
| Файл для сдачи                       | `day02_ex01.sql`                                                       |
| **Разрешено**                        |                                                                        |
| Язык                                 | ANSI SQL                                                               |
| Конструкции SQL                      | `generate_series(...)`                                                 |
| **Запрещено**                        |                                                                        |
| Конструкции SQL                      | `NOT IN`, `IN`, `NOT EXISTS`, `EXISTS`, `UNION`, `EXCEPT`, `INTERSECT` |

Напишите SQL-запрос, который вернёт **отсутствующие дни** в период с **1 по 10 января 2022** (включительно) для посещений людьми с идентификаторами 1 или 2 (т.е. пропущенные **обоими**). Отсортируйте даты по возрастанию.  

Пример данных:  

| missing_date |
| ------------ |
| 2022-01-03   |
| 2022-01-04   |
| 2022-01-05   |
| ...          |

---

## Глава VI

## Задание 02 — FULL означает «полностью заполненный»

| Задание 02: FULL означает «полностью заполненный» |                                                                        |
| ------------------------------------------------- | ---------------------------------------------------------------------- |
| Каталог для сдачи                                 | ex02                                                                   |
| Файл для сдачи                                    | `day02_ex02.sql`                                                       |
| **Разрешено**                                     |                                                                        |
| Язык                                              | ANSI SQL                                                               |
| **Запрещено**                                     |                                                                        |
| Конструкции SQL                                   | `NOT IN`, `IN`, `NOT EXISTS`, `EXISTS`, `UNION`, `EXCEPT`, `INTERSECT` |

Напишите SQL-запрос, который вернёт полный список имён людей, посещавших (или не посещавших) пиццерии в период с **1 по 3 января 2022**, а также список пиццерий, которые посещались (или нет).  

Для отсутствующих значений используйте `'-'` вместо `NULL` в столбцах `person_name` и `pizzeria_name`.  
Отсортируйте по всем трём столбцам.  

Пример результата:  

| person_name | visit_date | pizzeria_name |
| ----------- | ---------- | ------------- |
| -           | null       | DinoPizza     |
| -           | null       | DoDo Pizza    |
| Andrey      | 2022-01-01 | Dominos       |
| Andrey      | 2022-01-02 | Pizza Hut     |
| Anna        | 2022-01-01 | Pizza Hut     |
| Denis       | null       | -             |
| Dmitriy     | null       | -             |
| ...         | ...        | ...           |

---

## Глава VII

## Задание 03 — Переписать в CTE

| Задание 03: Переписать в CTE |                                                                        |
| ---------------------------- | ---------------------------------------------------------------------- |
| Каталог для сдачи            | ex03                                                                   |
| Файл для сдачи               | `day02_ex03.sql`                                                       |
| **Разрешено**                |                                                                        |
| Язык                         | ANSI SQL                                                               |
| Конструкции SQL              | `generate_series(...)`                                                 |
| **Запрещено**                |                                                                        |
| Конструкции SQL              | `NOT IN`, `IN`, `NOT EXISTS`, `EXISTS`, `UNION`, `EXCEPT`, `INTERSECT` |

Перепишите решение из **Задания 01**, используя **CTE** (Common Table Expression).  
Результат должен выглядеть так же, как в Задании 01.  

| missing_date |
| ------------ |
| 2022-01-03   |
| 2022-01-04   |
| 2022-01-05   |
| ...          |

---

## Глава VIII

## Задание 04 — Найти любимые пиццы

| Задание 04: Найти любимые пиццы |                  |
| ------------------------------- | ---------------- |
| Каталог для сдачи               | ex04             |
| Файл для сдачи                  | `day02_ex04.sql` |
| **Разрешено**                   |                  |
| Язык                            | ANSI SQL         |

Найдите полную информацию обо всех доступных пиццериях и ценах на **грибную** и **пепперони** пиццу.  
Отсортируйте результат по названию пиццы и названию пиццерии.  

Пример вывода:  

| pizza_name      | pizzeria_name | price |
| --------------- | ------------- | ----- |
| mushroom pizza  | Dominos       | 1100  |
| mushroom pizza  | Papa Johns    | 950   |
| pepperoni pizza | Best Pizza    | 800   |
| ...             | ...           | ...   |

---

## Глава IX

## Задание 05 — Анализ данных о людях

| Задание 05: Анализ данных о людях |                  |
| --------------------------------- | ---------------- |
| Каталог для сдачи                 | ex05             |
| Файл для сдачи                    | `day02_ex05.sql` |
| **Разрешено**                     |                  |
| Язык                              | ANSI SQL         |

Найдите имена всех женщин старше 25 лет.  
Отсортируйте результат по имени.  

Пример вывода:  

| name   |
| ------ |
| Elvira |
| ...    |

---

## Глава X

## Задание 06 — Любимые пиццы Дениса и Анны

| Задание 06: Любимые пиццы Дениса и Анны |                  |
| --------------------------------------- | ---------------- |
| Каталог для сдачи                       | ex06             |
| Файл для сдачи                          | `day02_ex06.sql` |
| **Разрешено**                           |                  |
| Язык                                    | ANSI SQL         |

Найдите все виды пиццы (и соответствующие пиццерии), которые заказывали **Денис** или **Анна**.  
Отсортируйте результат по обоим столбцам.  

Пример:  

| pizza_name   | pizzeria_name |
| ------------ | ------------- |
| cheese pizza | Best Pizza    |
| cheese pizza | Pizza Hut     |
| ...          | ...           |

---

## Глава XI

## Задание 07 — Самая дешёвая пиццерия для Дмитрия

| Задание 07: Самая дешёвая пиццерия для Дмитрия |                  |
| ---------------------------------------------- | ---------------- |
| Каталог для сдачи                              | ex07             |
| Файл для сдачи                                 | `day02_ex07.sql` |
| **Разрешено**                                  |                  |
| Язык                                           | ANSI SQL         |

Найдите название пиццерии, которую Дмитрий посетил **8 января 2022**, где он мог съесть пиццу дешевле **800 рублей**.  

---

## Глава XII

## Задание 08 — Продолжаем исследовать данные

| Задание 08: Продолжаем исследовать данные |                  |
| ----------------------------------------- | ---------------- |
| Каталог для сдачи                         | ex08             |
| Файл для сдачи                            | `day02_ex08.sql` |
| **Разрешено**                             |                  |
| Язык                                      | ANSI SQL         |

Найдите имена всех мужчин из **Москвы** или **Самары**, которые заказывают пиццу **пепперони** или **грибную** (или обе).  
Отсортируйте результат по имени в порядке убывания.  

Пример:  

| name    |
| ------- |
| Dmitriy |
| ...     |

---

## Глава XIII

## Задание 09 — Кто любит сырную и пепперони?

| Задание 09: Кто любит сырную и пепперони? |                  |
| ----------------------------------------- | ---------------- |
| Каталог для сдачи                         | ex09             |
| Файл для сдачи                            | `day02_ex09.sql` |
| **Разрешено**                             |                  |
| Язык                                      | ANSI SQL         |

Найдите имена всех женщин, которые заказывали **и пепперони, и сырную пиццу** (в разное время и в разных пиццериях).  
Результат отсортируйте по имени.  

Пример:  

| name |
| ---- |
| Anna |
| ...  |

---

## Глава XIV

## Задание 10 — Поиск людей из одного города

| Задание 10: Поиск людей из одного города |                  |
| ---------------------------------------- | ---------------- |
| Каталог для сдачи                        | ex10             |
| Файл для сдачи                           | `day02_ex10.sql` |
| **Разрешено**                            |                  |
| Язык                                     | ANSI SQL         |

Найдите имена людей, которые живут по одному адресу.  
Отсортируйте результат по имени первого человека, имени второго человека и общему адресу.  

Пример:  

| person_name1 | person_name2 | common_address |
| ------------ | ------------ | -------------- |
| Andrey       | Anna         | Moscow         |
| Denis        | Kate         | Kazan          |
| Elvira       | Denis        | Kazan          |
| ...          | ...          | ...            |